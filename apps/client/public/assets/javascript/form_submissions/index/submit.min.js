const atomizeForm=document.getElementById("atomize_form"),messageRenderer=document.getElementById("message-renderer");function showToast(e,t){if("success"===t){atomizeForm.reset(),messageRenderer.classList.toggle("hidden");const t=document.getElementById("message-iconbox"),n=document.getElementById("message-box"),s=document.getElementById("anonymous_user");t.innerHTML='<svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"\n                                xmlns="http://www.w3.org/2000/svg">\n                                <path fill-rule="evenodd"\n                                    d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd">\n                                </path>\n                            </svg>\n                            <span class="sr-only">Check icon</span>',n.innerHTML=`\n\t\t\t\t\t\t<a id="message_link" class="text-gray-400 transition-colors hover:text-gray-600" href="${e}">${e}</a>\n    `;const o=document.getElementById("copyIcon"),l=document.getElementById("copybtn"),a=document.getElementById("message_link"),i='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#6B7280"><path d="M20 2H10c-1.103 0-2 .897-2 2v4H4c-1.103 0-2 .897-2 2v10c0 1.103.897 2 2 2h10c1.103 0 2-.897 2-2v-4h4c1.103 0 2-.897 2-2V4c0-1.103-.897-2-2-2zM4 20V10h10l.002 10H4zm16-6h-4v-4c0-1.103-.897-2-2-2h-4V4h10v10z"/></svg>',r='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#6B7280"><path d="m10 15.586-3.293-3.293-1.414 1.414L10 18.414l9.707-9.707-1.414-1.414z"/></svg>';o.innerHTML=i,null!==s&&(s.innerHTML="Sign up to increase the limit of your atomic links");const c=async()=>{try{await navigator.clipboard.writeText(a.innerHTML),o.innerHTML=r}catch(e){console.log(`Failed to copy link - ${a} to clipboard!`)}setTimeout((()=>{o.innerHTML=i}),1500)};null!=a&&l.addEventListener("click",c)}else if("error"===t){messageRenderer.classList.toggle("hidden");const t=document.getElementById("message-iconbox"),n=document.getElementById("message-box");t.innerHTML='<svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>\n                             <span class="sr-only">Warning icon</span>',n.innerHTML=`${e}`;document.getElementById("copybtn").innerHTML='<svg aria-hidden="true" class="w-5 h-5" fill="#6B7280" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>'}}atomizeForm.addEventListener("submit",(async function(e){e.preventDefault();const t=document.getElementById("atomize_input").value;let n=document.getElementById("atomize_input_2")?.value,s=document.getElementById("user_id").value;null===s&&(console.log("Anonymous user"),s=null,n=20),console.log(s),await fetch("/v1/api/data/atomize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({longUrl:t,userId:s,limit:n})}).then((e=>e.json())).then((e=>{if(e.shortUrl){showToast(`${location.origin}/${e.shortUrl}`,"success")}else Array.isArray(e.message)&&e.message.length>=0?showToast(e.message[0],"error"):showToast(e.message,"error")}))}));
